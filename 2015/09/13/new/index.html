<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>这是一个娱乐博客</title>
  <meta name="description" content="这其实是一个娱乐博客" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" type="image/x-ico" href="/favicon.ico" />
  <link rel="stylesheet" type="text/css" href="/css/component.css" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <meta name="generator" content="hentaicracker">
  <script src="http://static.duoshuo.com/embed.js"></script>
  
  
  

  

</head>
<body>
<div class="container">
    <div class="mp-pusher" id="mp-pusher">
        <i id="scroll-up" class="fa fa-angle-up"></i>
        <nav id="mp-menu" class="mp-menu">
            <div class="mp-level">
                <a data-pjax class="back-home" style="font-size: 20px" href="/"><h2 ><i class="fa fa-home"></i>
                        Home</h2></a>
                <ul class="first-level">
                    <li>
                        <a class="fa fa-archive" href="#"><i class="fa fa-angle-left">
                            </i>&nbsp;&nbsp;文章</a>
                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-archive"></i>
                                Archive</h2>
                            <a class="mp-back" href="#">back</a>
                            <form id="search-form" action="">
                                <input type="text" class="search search-archive" placeholder="Search.."/>
                            </form>
                            <ul>
                                <div class="mp-scroll">
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/09/13/new/">JavaScript中的对象查找和变量提升</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/08/20/悲伤值计算/">悲伤值计算</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/08/10/article150810/">最近的感想</a>
                                </li>
                                
                                </div>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <a class="fa fa-copy" href="#"><i class="fa fa-angle-left">
                            </i>&nbsp;&nbsp;分类</a>

                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-copy"></i>
                                Categories</h2>
                            <a class="mp-back" href="#">back</a>
                            <form id="search-form" action="">
                                <input type="text" class="search search-category" placeholder="Search.."/>
                            </form>
                            <ul>
                                <div class="mp-scroll">
                                
                                <li class="search-category-li mp-pjax">
                                    <a href="/categories/JavaScript/">&nbsp;&nbsp;&nbsp;JavaScript</a>
                                    <small>1</small>
                                </li>
                                
                                <li class="search-category-li mp-pjax">
                                    <a href="/categories/日常/">&nbsp;&nbsp;&nbsp;日常</a>
                                    <small>2</small>
                                </li>
                                
                                </div>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <a class="fa fa-tags" href="#"><i class="fa fa-angle-left">
                            </i>&nbsp;&nbsp;标签</a>
                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-tags"></i> 
                                Tags</h2>
                            <a class="mp-back" href="#">back</a>
                            <form id="search-form" action="">
                                <input type="text" class="search search-tag" placeholder="Search.."/>
                            </form>
                            <ul>
                                <div class="mp-scroll">
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/JavaScript/">&nbsp;&nbsp;&nbsp;JavaScript</a>
                                    <small>1</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/工作/">&nbsp;&nbsp;&nbsp;工作</a>
                                    <small>1</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/生活/">&nbsp;&nbsp;&nbsp;生活</a>
                                    <small>2</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/随笔/">&nbsp;&nbsp;&nbsp;随笔</a>
                                    <small>1</small>
                                </li>
                                
                                </div>
                            </ul>
                        </div>
                    </li>
                    
                    <li><a class="fa fa-user" href="https://about.me/hentaicracker" target="_blank">&nbsp;&nbsp;&nbsp;About me</a></li>
                    <li><a class="fa fa-github" href="https://github.com/hentaicracker" target="_blank">&nbsp;&nbsp;&nbsp;Github</a></li>
                    <li><a class="fa fa-twitter" href="http://weibo.com/shenggegege" target="_blank">&nbsp;&nbsp;&nbsp;twitter</a></li>
                    <li><a class="fa fa-facebook" href="http://weibo.com/shenggegege" target="_blank">&nbsp;&nbsp;&nbsp;facebook</a></li>
                    <li><a class="fa fa-weibo" href="http://weibo.com/shenggegege" target="_blank">&nbsp;&nbsp;&nbsp;微博</a></li>

                </ul>

            </div>
        </nav>
        <div id="pjax">
            <div class="pjax-hidden" style="display: none">
                
                    <a  data-pjax href="/2015/09/13/new/">JavaScript中的对象查找和变量提升</a>
                
                    <a  data-pjax href="/2015/08/20/悲伤值计算/">悲伤值计算</a>
                
                    <a  data-pjax href="/2015/08/10/article150810/">最近的感想</a>
                
                
                    <a data-pjax href="/categories/JavaScript/">&nbsp;&nbsp;JavaScript</a>
                
                    <a data-pjax href="/categories/日常/">&nbsp;&nbsp;日常</a>
                
                
                    <a data-pjax href="/tags/JavaScript/">&nbsp;&nbsp;JavaScript</a>
                
                    <a data-pjax href="/tags/工作/">&nbsp;&nbsp;工作</a>
                
                    <a data-pjax href="/tags/生活/">&nbsp;&nbsp;生活</a>
                
                    <a data-pjax href="/tags/随笔/">&nbsp;&nbsp;随笔</a>
                
                <a data-pjax class="fa fa-user" href="/about">&nbsp;&nbsp;&nbsp;About me</a>
            </div>
            <nav class="nexus">
                <li  style="border-left: 1px solid #c6d0da;">
                    <a id="trigger" href="#"><i class="fa fa-bars"></i></a>
                </li>
                <li ><a id="nexus-back" data-pjax href="/">hentaicracker</a></li>
                
                <div id="nav-container">
                    <div class="post-navbar" style="line-height: 63px;display:none">
                        <li id="navbar-title"><a href="#">JavaScript中的对象查找和变量提升</a></li>
                        <li id="navbar-toc" style="border-left: none">
                            <a style="padding-right: 15px">
                                <span id="toc-content" >Introduction</span><i class="fa fa-chevron-down" ></i>
                            </a>
                            <div class="hidden-box">
                                <ul id="toc"></ul>
                            </div>
                        </li>
                    </div>
                </div>
                
            </nav>

            <div class="scroller">
            <div class="scroller-inner">


<!-- -->
<!--<body class="post-template">-->
<!---->
  

<main class="content" role="main">
    <article class="post" >
    <span class="post-meta">
                  <div class="tag-tile">
                      
                      
                      <a data-pjax href='/tags/JavaScript/' style='color:#D5D5D5'>JavaScript</a>
                      
                      
                  </div>
                <h1 class="post-title" style="margin: 14px 0;color:#50585D">JavaScript中的对象查找和变量提升</h1>

                    <div class="post-meta">
                        Post on<span class="fa fa-clock-o"></span>
                        <time datetime="2015-09-13T13:27:10.000Z"
                              itemprop="datePublished">2015-09-13</time>
                    </div>
    </span>

        <section class="post-content">
            <p>最近做了一些前端笔试题，被虐得体无完肤…像美团和腾讯这些互联网公司出的前端笔试题真是恶心，数据结构、算法、网络、操作系统、C语言等等啥都有。T.T上次我去讯飞面试的时候，HR给了我一个笔试题，说先让我做，做完了再面试。当时我磨刀霍霍，因为前些日子恶补了很多JavaScript的基础知识，然后各种前端面试题、笔试题也都有做过一些。结果我一拿到卷子，全是数据结构和算法、C/C++、网络、操作系统啥的，顿时脑子里一片空白，因为我操作系统、网络这些都没摸过啊T.T。于是乎，交了白卷。好在HR比较善良和单纯，还是让我进行了面试。扯远了……<br>回到正题，最近做的一些JavaScript笔试题会经常遇到下面的一种题型：</p>
<pre><code>x = <span class="number">1</span>;
<span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">()</span> </span>{
    <span class="keyword">this</span>.x = <span class="number">2</span>;
    <span class="keyword">return</span> x;
}
<span class="keyword">var</span> foo = <span class="keyword">new</span> bar();
alert(foo.x); <span class="comment">// 2</span>
alert(x); <span class="comment">// 1</span>
</code></pre><h3 id="对象查找(先查找声明，再看赋值)">对象查找(先查找声明，再看赋值)</h3><p>—变量查找，如foo++;，这里就会去查找一个叫作foo的变量。<br>—属性查找，如foo.bar++;，这里会去查找foo这个变量下的一个叫作bar的属性。<br>—this查找，即针对this关键字的处理。<br>var foo = this;<br>foo.bar();<br>这2行的代码就体现了3种对象查找，分别为：</p>
<ul>
<li>查找this对象，并赋值给foo变量。</li>
<li>查看foo变量。</li>
<li>查找foo变量下的bar属性，并将之作为一个函数进行调用。</li>
</ul>
<pre><code><span class="bullet">* </span>变量的查找
</code></pre><p>变量查找，即在作用域链上进行查找<br>var foo = 1;<br>function a() {<br>     var bar = 2;<br>     function b() {<br>          foo = 3;<br>          function c() {<br>               console.log(foo + ‘,’ + bar);<br>          }<br>          c();<br>     }<br>     b();<br>}<br>a();<br>变量的查找可以简单地遵守从下向上的原则，即：</p>
<ul>
<li>在函数c的范围内查找foo和bar，显然在c里面并没有foo和bar的声明，查找失败。</li>
<li>在包含c的函数，即函数b的范围内查找foo和bar，可以看到b里面只有对foo的赋值，并没有声明，查找失败。</li>
<li>在包括b的函数，即函数a的范围内查找foo和bar，可以找到bar的声明，因此确定bar为2。</li>
<li>由于a不被任何函数包含，那么就在全局作用域内查找foo，发现有foo的声明，因此确定foo的值为1。但是由于在函数b中，对这个foo有赋值，所以foo的值被修改为3。</li>
<li>完确定foo的值为3，bar的值为2，因此输出3,2。<br>变量的查找是延着作用域链进行的，作用域链可以简单地看成函数间的包含关系，被包含的函数中不存在某个变量时，在包含他的函数中查找，直到全局作用域。</li>
</ul>
<pre><code><span class="bullet">* </span>属性的查找
</code></pre><p>属性查找，即在原型链上进行查找。<br>var a = function() {};<br>var b = function() {};<br>var c = function() {};<br>b.prototype = new a();<br>c.prototype = new b();<br>a.prototype.foo = 1;<br>b.prototype.bar = 2;<br>c.prototype.foo = 3;<br>var o = new c();<br>console.log(o.foo + ‘,’ + o.bar);<br>属性查找是一个不断寻找prototype的过程，即：</p>
<ul>
<li>查找c.prototype中，有没有显示定义foo和bar，发现定义了foo，其值为3。</li>
<li>发现c.prototype就是new b()得到的对象，那么查找b.prototype中，有没有显示定义bar，发现定义了，其值为2。</li>
<li>因此确定foo的值为3，bar的值为2，输出”3,2”。<br>属性查找是延着原型链进行的，所有的对象，其原型链最终会是Object.prototype，再向上就是null了。</li>
</ul>
<pre><code>* <span class="keyword">this</span>的查找
</code></pre><p>首先，this对象只会在一个函数中需要确定，如果是在全局域下，this永远为Global对象，在浏览器中通常就是window对象。而在javascript中，函数的调用一共有4种方式：</p>
<ul>
<li><p>Function Invocation Pattern<br>诸如foo()的调用形式被称为Function Invocation Pattern，是函数最直接的使用形式，注意这里的foo是作为单独的变量出现，而不是属性。<br>在这种模式下，foo函数体中的this永远为Global对象，在浏览器中就是window对象。</p>
</li>
<li><p>Method Invocation Pattern<br>诸如foo.bar()的调用形式被称为Method Invocation Pattern，注意其特点是被调用的函数作为一个对象的属性出现，必然会有“.”或者“[]”这样的关键符号。<br>在这种模式下，bar函数体中的this永远为“.”或“[”前的那个对象，如上例中就一定是foo对象。</p>
</li>
<li><p>Constructor Pattern<br>new foo()这种形式的调用被称为Constructor Pattern，其关键字new就很能说明问题，非常容易识别。<br>在这种模式下，foo函数内部的this永远是new foo()返回的对象。</p>
</li>
<li><p>Apply Pattern<br>foo.call(thisObject)和foo.apply(thisObject)的形式被称为Apply Pattern，使用了内置的call和apply函数。<br>在这种模式下，call和apply的第一个参数就是foo函数体内的this，如果thisObject是null或undefined，那么会变成Global对象。</p>
</li>
</ul>
<p>对于一个对象的查找：</p>
<ul>
<li>确定是变量查找、属性查找还是this查找。</li>
<li>如果是变量查找，则延作用域链找，找不到就是ReferenceError。</li>
<li>如果是属性查找，就延原型链找，找不以就是undefined。</li>
<li>如果是this查找，去找调用函数的代码，根据调用的形式来确定this是什么。<br>注意把一次查找过程拆分开来，比如this.foo.bar.yahoo()，可以拆分成这样的代码，就能更清楚了：</li>
</ul>
<p>var o = this; // this查找<br>var foo = o.this; // 属性查找<br>var bar = foo.bar; // 属性查找<br>bar.yahoo(); // 属性查找，加Method Invocation Pattern  </p>
<ul>
<li>为什么延作用域查找不到会有ReferenceError。</li>
<li>其实变量也是属性，一个特殊对象的属性。</li>
<li>this也许不是Global，也许会是undefined。</li>
</ul>
<p>变量提升<br>javascript中一个名字(name)以四种方式进入作用域(scope)，其优先级顺序如下：<br>1、语言内置：所有的作用域中都有 this 和 arguments 关键字<br>2、形式参数：函数的参数在函数作用域中都是有效的<br>3、函数声明：形如function foo() {}<br>4、变量声明：形如var bar;</p>
<p>(function(){<br>  var a = “1”;<br>  var f = function(){};<br>  var b = “2”;<br>  var c = “3”;<br>})();<br>变量a,f,b,c的声明会被提升到函数作用域的最前面，类似如下：<br>(function(){<br>  var a,f,b,c;<br>  a = “1”;<br>  f = function(){};<br>  b = “2”; c = “3”;<br>})();<br>注意函数表达式并没有被提升，这也是函数表达式与函数声明的区别。进一步看二者的区别：<br>(function(){<br>     //var f1,function f2(){}; //hoisting,被隐式提升的声明<br>     f1(); //ReferenceError: f1 is not defined<br>     f2();<br>     var f1 = function(){};<br>     function f2(){}<br>})();</p>
<p>命名函数表达式的名字只在该函数的作用域内部有效。</p>

        </section>
        <hr/>
        <nav class="pagination" style="width:auto" role="pagination">
            
            <a style="cursor:default" class="newer-posts" href="#">This is the First Post</a>
            
            <a class="share-button" data-original-title title>Share this Post</a>
            
            <a data-pjax class="older-posts" href="/2015/08/20/悲伤值计算/">Next Post →</a>
            
        </nav>
        <br/>
        <br/>
        <section id="comment">
            <div id="comment-box"></div>
        </section>


    </article>
</main>


  
<footer class="site-footer">
    
    <div class="inner">
        <section class="copyright"><a href="/"></a> &copy; hentaicracker 2014</section>
        <section class="poweredby">Published with <a target="_blank" href="http://hexo.io/">Hexo   </a> and Theme by <a target="_blank" href="https://github.com/yuche/hexo-theme-kael">Kael</a></section>
    </div>
</footer>
</div>
</div><!-- /scroller -->

</div><!-- /pusher -->
</div><!-- /container -->
</div>

<!-- Easter eggs -->

<div class="egg animated">
    <a id="close-button" href="#">X</a>
    <div class="block">
        <div class="loading">
            <span class="ball1"></span>
            <span class="ball2"></span>
        </div>
    </div>
</div>
  
<script src="//cdn.staticfile.org/jquery/1.11.0/jquery.min.js"></script>
<script>
    if (!window.jQuery) {
        var script = document.createElement('script');
        script.src = "/js/jquery.min.js";
        document.body.appendChild(script);
    }
</script>
<script type="text/javascript" src="/js/lib.js"></script>
<script type="text/javascript" src="/js/main.js"></script>







</body>
</html>
