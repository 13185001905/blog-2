<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> JavaScript Tips · 陈俊生的正经博客</title><meta name="description" content="JavaScript Tips - Jason Chen"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.ico"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://hentaicracker.com/atom.xml" title="陈俊生的正经博客"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/blog.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">博客</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">归档</a></li><li class="nav-list-item"><a href="/tag/" target="_self" class="nav-list-link">分类</a></li><li class="nav-list-item"><a href="http://weibo.com/shenggegege" target="_blank" class="nav-list-link">微博</a></li><li class="nav-list-item"><a href="https://github.com/hentaicracker" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS订阅</a></li><li class="nav-list-item"><a href="http://hentaicracker.github.io/share/aboutme.html" target="_blank" class="nav-list-link">关于我</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">JavaScript Tips</h1><div class="post-info">2017年3月17日</div><div class="post-content"><p>总结一下在工作中经常遇到的一些js处理方法。</p>
<a id="more"></a>
<h3 id="数组去重"><a href="#数组去重" class="headerlink" title="数组去重"></a>数组去重</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> deduped = [ <span class="number">1</span>, <span class="number">1</span>, <span class="string">'a'</span>,<span class="string">'a'</span> ].filter(<span class="function"><span class="keyword">function</span> (<span class="params">el, i, arr</span>) </span>&#123;</div><div class="line">     <span class="keyword">return</span> arr.indexOf(el) === i;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(deduped); <span class="comment">// [ 1, 'a']</span></div></pre></td></tr></table></figure>
<h4 id="es6"><a href="#es6" class="headerlink" title="es6"></a>es6</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> deduped = [ <span class="number">1</span>, <span class="number">1</span>, <span class="string">'a'</span>,<span class="string">'a'</span> ].filter( (el, i, arr) =&gt; arr.indexOf(el) ===i );</div></pre></td></tr></table></figure>
<h4 id="Objects"><a href="#Objects" class="headerlink" title="Objects"></a>Objects</h4><p>当元素为对象(Object)时，我们就不能用这种办法了， 因为对象存储的是引用而原始变量存储的是值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123; a: <span class="number">1</span> &#125; === &#123; a: <span class="number">1</span> &#125; <span class="comment">// false</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">dedup</span>(<span class="params">arr</span>) </span>&#123;</div><div class="line">     <span class="keyword">var</span> hashTable = &#123;&#125;;</div><div class="line">     <span class="keyword">return</span> arr. filter(<span class="function"><span class="keyword">function</span>(<span class="params">el</span>) </span>&#123;</div><div class="line">          <span class="keyword">var</span> key = <span class="built_in">JSON</span>.stringify(el);</div><div class="line">          <span class="keyword">var</span> match = <span class="built_in">Boolean</span>(hashTable[key]);</div><div class="line">          <span class="keyword">return</span> (match ? <span class="literal">false</span> : hashTable[key] = <span class="literal">true</span>);</div><div class="line">     &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> deduped = dedup([</div><div class="line">        &#123; a: <span class="number">1</span> &#125;,</div><div class="line">        &#123; a: <span class="number">1</span> &#125;,</div><div class="line">        [ <span class="number">1</span>, <span class="number">2</span> ],</div><div class="line">        [ <span class="number">1</span>, <span class="number">2</span> ]</div><div class="line">]);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(deduped); <span class="comment">// [ &#123;a: 1&#125;, [1, 2] ]</span></div></pre></td></tr></table></figure>
<h3 id="多维数组扁平化"><a href="#多维数组扁平化" class="headerlink" title="多维数组扁平化"></a>多维数组扁平化</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myArray = [[<span class="number">1</span>, <span class="number">2</span>],[<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], [<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]];</div><div class="line"><span class="comment">// 期望值[1, 2, 3, 4, 5, 6, 7, 8, 9]</span></div></pre></td></tr></table></figure>
<h4 id="使用concat-和apply"><a href="#使用concat-和apply" class="headerlink" title="使用concat()和apply()"></a>使用concat()和apply()</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> newArray = [].concat.apply([], myArray);</div></pre></td></tr></table></figure>
<h4 id="使用reduce"><a href="#使用reduce" class="headerlink" title="使用reduce()"></a>使用reduce()</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> newArray = myArray.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">prev, curr</span>) </span>&#123;</div><div class="line">     <span class="keyword">return</span> prev.concat(curr);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h4 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> newArray = [];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; myArray.length; ++i) &#123;</div><div class="line">     <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; myArray.length; ++j) &#123;</div><div class="line">          newArray.push(myArray[i][j]);</div><div class="line">     &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="ES6展开符"><a href="#ES6展开符" class="headerlink" title="ES6展开符"></a>ES6展开符</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> newArray = [].concat(...myArray);</div></pre></td></tr></table></figure>
<h3 id="数组平均值-amp-amp-中位数"><a href="#数组平均值-amp-amp-中位数" class="headerlink" title="数组平均值&amp;&amp;中位数"></a>数组平均值&amp;&amp;中位数</h3><h4 id="平均值"><a href="#平均值" class="headerlink" title="平均值"></a>平均值</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> values = [<span class="number">2</span>, <span class="number">56</span>, <span class="number">3</span>, <span class="number">41</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">100</span>, <span class="number">23</span>];</div><div class="line"><span class="keyword">let</span> sum = values.reduce((prev, curr) =&gt; curr += prev);</div><div class="line"><span class="keyword">let</span> avg = sum / values.length;</div><div class="line"><span class="comment">// avg = 28</span></div></pre></td></tr></table></figure>
<h4 id="中位数"><a href="#中位数" class="headerlink" title="中位数"></a>中位数</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> values = [<span class="number">2</span>, <span class="number">56</span>, <span class="number">3</span>, <span class="number">41</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">100</span>, <span class="number">23</span>];</div><div class="line">values.sort((a, b) =&gt; a - b);</div><div class="line"><span class="keyword">let</span> lowMiddle = <span class="built_in">Math</span>.floor((values.length - <span class="number">1</span>) / <span class="number">2</span>);</div><div class="line"><span class="keyword">let</span> highMiddle = <span class="built_in">Math</span>.ceil((values.length - <span class="number">1</span>) / <span class="number">2</span>);</div><div class="line"><span class="keyword">let</span> median = (values[lowMiddle] + values[highMiddle]) / <span class="number">2</span>;</div><div class="line"><span class="comment">// median = 13.5</span></div></pre></td></tr></table></figure>
<p>如果是对象的话，JavaScript将引用按值传递。</p>
<h3 id="JS监听document是否加载完成"><a href="#JS监听document是否加载完成" class="headerlink" title="JS监听document是否加载完成"></a>JS监听document是否加载完成</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="built_in">document</span>.readyState === <span class="string">'complete'</span>) &#123;</div><div class="line">     <span class="comment">// 页面已完全加载</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>使用document.readyState === ‘interactive’监听DOM是否加载完成。</p>
<h3 id="判断数据元素是否重复"><a href="#判断数据元素是否重复" class="headerlink" title="判断数据元素是否重复"></a>判断数据元素是否重复</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> isRepeat = <span class="function"><span class="keyword">function</span>(<span class="params">arr</span>)</span>&#123;</div><div class="line">     <span class="keyword">var</span> hash = &#123;&#125;;</div><div class="line">     <span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> arr) &#123;</div><div class="line">          <span class="keyword">if</span>(hash[arr[i]]) <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">          hash[arr[i]] = <span class="literal">true</span>;</div><div class="line">     &#125;</div><div class="line">     <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="生成随机数"><a href="#生成随机数" class="headerlink" title="生成随机数"></a>生成随机数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">randombetween</span>(<span class="params">min, max</span>) </span>&#123;</div><div class="line">     <span class="keyword">return</span> min + (<span class="built_in">Math</span>.random() * (max - min + <span class="number">1</span>));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="javascript对象浅拷贝-amp-深拷贝"><a href="#javascript对象浅拷贝-amp-深拷贝" class="headerlink" title="javascript对象浅拷贝&amp;深拷贝"></a>javascript对象浅拷贝&amp;深拷贝</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">;(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> obj = &#123; a: <span class="number">1</span>, b: &#123; c: <span class="number">2</span>&#125; &#125;;</div><div class="line">    <span class="keyword">var</span> copy = <span class="built_in">Object</span>.assign(&#123;&#125;, obj);  <span class="comment">// 拷贝源对象自身的并且可枚举的属性</span></div><div class="line">    <span class="built_in">console</span>.log(copy);      <span class="comment">// &#123; a: 1, b: &#123; c: 2&#125; &#125;</span></div><div class="line">    <span class="keyword">var</span> deepCopy = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj));</div><div class="line">    copy.a = <span class="number">2</span>;</div><div class="line">    copy.b.c = <span class="number">3</span>;</div><div class="line">    <span class="built_in">console</span>.log(obj);       <span class="comment">// &#123; a: 1, b: &#123; c: 3&#125; &#125;</span></div><div class="line">    <span class="built_in">console</span>.log(copy);      <span class="comment">// &#123; a: 2, b: &#123; c: 3&#125; &#125;</span></div><div class="line">    <span class="built_in">console</span>.log(deepCopy);  <span class="comment">// &#123; a: 1, b: &#123; c: 2&#125; &#125;</span></div><div class="line">    deepCopy.a = <span class="number">4</span>;</div><div class="line">    deepCopy.b.c = <span class="number">5</span>;</div><div class="line">    <span class="built_in">console</span>.log(obj);       <span class="comment">// &#123; a: 1, b: &#123; c: 3&#125; &#125;</span></div><div class="line">    <span class="built_in">console</span>.log(copy);      <span class="comment">// &#123; a: 2, b: &#123; c: 3&#125; &#125;</span></div><div class="line">    <span class="built_in">console</span>.log(deepCopy);  <span class="comment">// &#123; a: 4, b: &#123; c: 5&#125; &#125;</span></div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<h3 id="判断变量是否为数组"><a href="#判断变量是否为数组" class="headerlink" title="判断变量是否为数组"></a>判断变量是否为数组</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// es5方法 Array.prototype.isArray();</span></div><div class="line"></div><div class="line"><span class="comment">// 通用判断类型方法</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArray</span>(<span class="params">arr</span>) </span>&#123;</div><div class="line">     <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(arr) === <span class="string">'[object Array]'</span>;</div><div class="line">     <span class="comment">// [[NativeBrand]]内部属性的值一共有十几种.分别是:"Array", "Boolean", "Date", "Error", "Function", "Math", "Number", "Object", "RegExp", "String","JSON","Arguments". // es6: "Map","Set","Symbol"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="生成随机数-1"><a href="#生成随机数-1" class="headerlink" title="生成随机数"></a>生成随机数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArray</span>(<span class="params">a</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(a) === <span class="string">'[object Array]'</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">rank</span>(<span class="params">arr</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span>(!isArray(arr)) <span class="keyword">return</span>;</div><div class="line">  <span class="keyword">return</span> arr.sort(() =&gt; <span class="number">0.5</span> - <span class="built_in">Math</span>.random());</div><div class="line">&#125;</div><div class="line">rank([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]);</div></pre></td></tr></table></figure></div></article></div></section><footer><div class="paginator"><a href="/2017/07/10/string/" class="prev">上一篇</a><a href="/2017/03/12/2017-03-12/" class="next">下一篇</a></div><div data-thread-key="2017/03/17/jsTips/" data-title="JavaScript Tips" data-url="http://hentaicracker.com/2017/03/17/jsTips/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"hentaicracker"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2016 - 2017 <a href="http://hentaicracker.com">Jason Chen</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-84370929-1",'auto');ga('send','pageview');</script></body></html>